#ifndef DEMODULATION_H_
#define DEMODULATION_H_

#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>

#include "filter.h"

/*

 FIR filter(s) designed with
 http://t-filter.appspot.com

 */

static double highpassImpulse[] = { -0.007841378739478247, -0.007888948215431272,
		-0.009718678129505453, -0.009776234634601727, -0.00730891192450578,
		-0.0019478042136496523, 0.005957227721681907, 0.015342233001297728,
		0.0244505354193565, 0.031152478399515966, 0.03335884913930142,
		0.029582112951520582, 0.01934342149529119, 0.003528426282687539,
		-0.015678104773609657, -0.03499368549736119, -0.05071570387259263,
		-0.0593658598753739, -0.058569688535852045, -0.04755196923810589,
		-0.027537532997002408, -0.0015362091690801238, 0.026067453610093702,
		0.05042627503844631, 0.06709954502226752, 0.0730310101613527,
		0.06709954502226752, 0.05042627503844631, 0.026067453610093702,
		-0.0015362091690801238, -0.027537532997002408, -0.04755196923810589,
		-0.058569688535852045, -0.0593658598753739, -0.05071570387259263,
		-0.03499368549736119, -0.015678104773609657, 0.003528426282687539,
		0.01934342149529119, 0.029582112951520582, 0.03335884913930142,
		0.031152478399515966, 0.0244505354193565, 0.015342233001297728,
		0.005957227721681907, -0.0019478042136496523, -0.00730891192450578,
		-0.009776234634601727, -0.009718678129505453, -0.007888948215431272,
		-0.007841378739478247 };

/*
The impulse response for the lowpass filter used in envelope detection

sampling frequency: 44100 Hz

* 0 Hz - 334 Hz
  gain = 1
  desired ripple = 5 dB
  actual ripple = 1.7756008175022506 dB

* 1000 Hz - 22000 Hz
  gain = 0
  desired attenuation = -40 dB
  actual attenuation = -47.29330081153328 dB

*/

static double envelopeImpulse[] = {
  -0.002490889431482704,
  -0.0006930604259677252,
  -0.0007863164296081515,
  -0.0008651027331041035,
  -0.0009544363050579762,
  -0.0010257132836282714,
  -0.0011038467413910817,
  -0.0011600575377887605,
  -0.0012187681244600784,
  -0.0012508832333148335,
  -0.001280885708978192,
  -0.0012794787453143238,
  -0.0012710599819207825,
  -0.0012260996847169017,
  -0.0011691607249311113,
  -0.001070677582013811,
  -0.0009555236143975971,
  -0.0007939414430039348,
  -0.0006111880291527863,
  -0.00037754998787942613,
  -0.00011934085313823514,
  0.0001937159627892104,
  0.0005336185414649186,
  0.0009327350324406502,
  0.0013580153444389539,
  0.001843714715248298,
  0.002362812057359466,
  0.0029345971738153885,
  0.003539346365107888,
  0.004200534425916346,
  0.004891513945887475,
  0.00563427894694248,
  0.0064018059255688455,
  0.00721758003171765,
  0.008053540925460139,
  0.008932354638951276,
  0.009824273227550213,
  0.010751399068678185,
  0.01168305209153604,
  0.012641190124280416,
  0.013594518623652711,
  0.01456505783787842,
  0.015521053388965304,
  0.016484280747807695,
  0.017421993414737703,
  0.01835605047237139,
  0.019253764881179847,
  0.020137190245167674,
  0.020973432300041322,
  0.021783861306344004,
  0.02253863857284835,
  0.023257276059988084,
  0.023909671521819477,
  0.02451874266650403,
  0.02505339458173916,
  0.025536712423586266,
  0.025938390708956316,
  0.026283334231420433,
  0.026541855872415924,
  0.026739497653685298,
  0.026847491999549996,
  0.02689272148083389,
  0.026847491999549996,
  0.026739497653685298,
  0.026541855872415924,
  0.026283334231420433,
  0.025938390708956316,
  0.025536712423586266,
  0.02505339458173916,
  0.02451874266650403,
  0.023909671521819477,
  0.023257276059988084,
  0.02253863857284835,
  0.021783861306344004,
  0.020973432300041322,
  0.020137190245167674,
  0.019253764881179847,
  0.01835605047237139,
  0.017421993414737703,
  0.016484280747807695,
  0.015521053388965304,
  0.01456505783787842,
  0.013594518623652711,
  0.012641190124280416,
  0.01168305209153604,
  0.010751399068678185,
  0.009824273227550213,
  0.008932354638951276,
  0.008053540925460139,
  0.00721758003171765,
  0.0064018059255688455,
  0.00563427894694248,
  0.004891513945887475,
  0.004200534425916346,
  0.003539346365107888,
  0.0029345971738153885,
  0.002362812057359466,
  0.001843714715248298,
  0.0013580153444389539,
  0.0009327350324406502,
  0.0005336185414649186,
  0.0001937159627892104,
  -0.00011934085313823514,
  -0.00037754998787942613,
  -0.0006111880291527863,
  -0.0007939414430039348,
  -0.0009555236143975971,
  -0.001070677582013811,
  -0.0011691607249311113,
  -0.0012260996847169017,
  -0.0012710599819207825,
  -0.0012794787453143238,
  -0.001280885708978192,
  -0.0012508832333148335,
  -0.0012187681244600784,
  -0.0011600575377887605,
  -0.0011038467413910817,
  -0.0010257132836282714,
  -0.0009544363050579762,
  -0.0008651027331041035,
  -0.0007863164296081515,
  -0.0006930604259677252,
  -0.002490889431482704
};

int demodulate(char inputFile[]); 

#endif